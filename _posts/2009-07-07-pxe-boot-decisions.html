--- 
layout: post
title: PXE boot decisions
mt_id: 46
---
<a href="http://syslinux.zytor.com/">SYSLINUX/PXELINUX</a>&nbsp;is officially awesome. You've almost certainly already used it - while booting from a Linux installation CD - and probably already use it if you do any PXE stuff.<div>What you may not knew is that it provides an&nbsp;<a href="http://syslinux.zytor.com/wiki/index.php/Comboot_API">API</a>&nbsp;programs can use, it can directly execute specially crafted DOS command binaries (COM), and even has a special 32-bit mode for these programs (the collection of these is "<a href="http://syslinux.zytor.com/wiki/index.php/Comboot_API">Comboot API</a>").</div><div><br /></div><div>There are lots of cool things in the API and the <a href="http://git.kernel.org/?p=boot/syslinux/syslinux.git;a=tree;f=com32;hb=HEAD">extensive sample programs</a>. Especially nice is the readily available <a href="http://git.kernel.org/?p=boot/syslinux/syslinux.git;a=blob;f=com32/gplinclude/dmi/dmi.h">DMI&nbsp;support</a> in the API.</div><div><div><br /></div><div>This made my task an easy journey. First, what I wanted to actually do:</div><div><br /></div><div><ul><li>If a machine gets booted from PXE (from any location, we have a central TFTP server),</li><li>if it is a server of a known model, auto-boot into a customized <a href="http://grml.org/">grml</a> environment for auto-deployment,</li><li>else present our standard PXE boot menu for OS installation/recovery purposes.</li></ul></div><div><br /></div><div>And this basically boils down to:</div><div><br /></div><div><ul><li>Write a small Comboot program which checks the DMI product_name against a pre-defined string (for HP ProLiant servers this unsurprisingly starts with "ProLiant") and dispatches to two different PXELINUX configuration files. I named <a href="http://github.com/zeha/syslinux/blob/8f57ad47f822ebb992c4cd320367c78112ec72ce/com32/modules/proliant.c">this program proliant.c32</a>.</li><li>Write pxelinux.cfg/default which does exactly one thing: auto-load proliant.c32.</li><li>Write the seperate PXELINUX configuration files.</li></ul><div><br /></div></div></div> 
